{% extends "app/base.html" %}
{% load static %}

{% block title %}Añadir Nuevo Producto{% endblock %}

{% block content %}
<div class="row justify-content-center fade-in-up">
    <div class="col-lg-10">

        <!-- TARJETA MODERNA -->
        <div class="card-modern bg-white p-4 shadow-lg border-0">

            <!-- ENCABEZADO CON ÍCONO -->
            <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                <div>
                    <h3 class="fw-bold text-dark mb-1">Nuevo Producto</h3>
                    <p class="text-muted small mb-0">Registrar material en el inventario.</p>
                </div>
                <div class="p-3 rounded-circle bg-success-subtle text-success">
                    <i class="bi bi-plus-lg fs-4"></i>
                </div>
            </div>

            <!-- Mostrar errores generales del formulario si existen -->
            {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {{ form.non_field_errors }}
            </div>
            {% endif %}

            <form method="post">
                {% csrf_token %}

                <!-- SECCIÓN 1: IDENTIFICACIÓN PRINCIPAL -->
                <div class="bg-light rounded-3 p-3 mb-4">
                    <h6 class="text-uppercase text-primary fw-bold small mb-3 ls-1">
                        <i class="bi bi-tag-fill me-1"></i> Identificación
                    </h6>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">SKU *</label>
                            {{ form.sku }}
                            {% if form.sku.errors %}<div class="text-danger small">{{ form.sku.errors.0 }}</div>{% endif %}
                        </div>
                        <div class="col-md-8">
                            <label class="form-label small fw-bold text-secondary">Nombre de Tela *</label>
                            {{ form.nombre_tela }}
                            {% if form.nombre_tela.errors %}<div class="text-danger small">{{ form.nombre_tela.errors.0 }}</div>{% endif %}
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN 2: CARACTERÍSTICAS -->
                <div class="row g-3 mb-4">
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-secondary">Tipo</label>
                        {{ form.tipo }}
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-secondary">Composición</label>
                        {{ form.composicion }}
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-secondary">Color</label>
                        {{ form.color }}
                    </div>
                </div>

                <!-- SECCIÓN 3: DIMENSIONES Y PESO -->
                <div class="row g-3 mb-4">
                    <div class="col-6 col-md-3">
                        <label class="form-label small fw-bold text-secondary">Largo (m)</label>
                        {{ form.largo }}
                    </div>
                    <div class="col-6 col-md-3">
                        <label class="form-label small fw-bold text-secondary">Ancho (m)</label>
                        {{ form.ancho }}
                    </div>
                    <div class="col-6 col-md-3">
                        <label class="form-label small fw-bold text-secondary">Peso Unitario (kg)</label>
                        {{ form.peso_por_pieza }}
                    </div>
                    <div class="col-6 col-md-3">
                        <label class="form-label small fw-bold text-secondary">Peso Aprox Total</label>
                        {{ form.peso_aprox }}
                    </div>
                </div>

                <!-- SECCIÓN 4: LOGÍSTICA (EMPAQUE) -->
                <div class="bg-light rounded-3 p-3 mb-4 border border-light">
                    <h6 class="text-uppercase text-primary fw-bold small mb-3 ls-1">
                        <i class="bi bi-box-seam me-1"></i> Configuración de Empaque
                    </h6>
                    <div class="row g-3">
                        <div class="col-4">
                            <label class="form-label small fw-bold text-secondary">Pz por Paquete</label>
                            {{ form.paquete_pz }}
                        </div>
                        <div class="col-4">
                            <label class="form-label small fw-bold text-secondary">Paquetes x Bulto</label>
                            {{ form.paquetes_bulto }}
                        </div>
                        <div class="col-4">
                            <label class="form-label small fw-bold text-secondary">Total Pz Bulto</label>
                            {{ form.bulto_pz }}
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN 5: STOCK INICIAL Y UBICACIÓN -->
                <div class="row g-3 mb-4">
                    <div class="col-md-4">
                        <label class="form-label small fw-bold text-secondary">Stock Inicial (Piezas)</label>
                        {{ form.pz }}
                    </div>
                    <div class="col-md-8">
                        <label class="form-label small fw-bold text-secondary">Ubicación en Bodega</label>
                        {{ form.ubicacion }}
                    </div>
                </div>

                <!-- NOTAS -->
                <div class="mb-4">
                    <label class="form-label small fw-bold text-secondary">Descripción / Notas</label>
                    {{ form.descripcion }}
                </div>

                <!-- BOTONES DE ACCIÓN -->
                <div class="d-flex justify-content-end gap-3 pt-3 border-top">

                    <!--
                       BOTÓN CANCELAR (CORREGIDO):
                       Es un simple enlace <a>. Al hacer clic, navega a la lista.
                       NO valida el formulario, NO envía datos. Solo sale.
                    -->
                    <a href="{% url 'app:lista_productos' %}" class="btn btn-light border px-4 rounded-pill fw-semibold text-muted shadow-sm text-decoration-none d-flex align-items-center">
                        <i class="bi bi-x-lg me-2"></i> Cancelar
                    </a>

                    <!-- BOTÓN GUARDAR -->
                    <button type="submit" class="btn btn-gradient px-5 rounded-pill shadow text-white fw-bold border-0">
                        <i class="bi bi-check-lg me-2"></i> Guardar Producto
                    </button>
                </div>

            </form>
        </div>
    </div>
</div>

<style>
    /* Detalles de diseño específicos para el formulario */
    .ls-1 {
        letter-spacing: 1px;
    }

    /* Animación de entrada */
    .fade-in-up {
        animation: fadeInUp 0.6s ease-out forwards;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Estilizar los inputs para que se vean modernos */
    input.form-control, select.form-select, textarea.form-control {
        border-radius: 10px;
        padding: 10px 15px;
        border: 1px solid #e5e7eb;
        font-size: 0.95rem;
        transition: all 0.2s;
    }

        input.form-control:focus, select.form-select:focus, textarea.form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
            outline: none;
        }

    /* Fondo sutil para secciones */
    .bg-success-subtle {
        background-color: #dcfce7 !important;
        color: #166534 !important;
    }

    /* Estilo para botón gradiente (si no está en style.css) */
    .btn-gradient {
        background: linear-gradient(135deg, var(--primary-color, #4f46e5), #4338ca);
        transition: transform 0.2s, box-shadow 0.2s;
    }

        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }
</style>
{% endblock %}